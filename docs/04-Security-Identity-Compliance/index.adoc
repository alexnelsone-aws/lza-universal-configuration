[#top]

:toc: left
:toclevels: 3
:doctype: book
:icons: font
:iconfont-remote!:
:iconfont-name: icons

= Security, Identity, and Compliance

== Introduction to Landing Zone Security

A landing zone is a well-architected, multi-account AWS environment that provides a secure foundation for deploying workloads and applications. The security architecture of a landing zone is critical as it establishes the controls and guardrails that protect your resources, data, and workloads across your AWS environment.

The Landing Zone Accelerator on AWS (LZA) Universal Configuration implements a comprehensive security framework built on AWS security best practices and services. This framework provides multiple layers of protection through preventative, detective and architectural controls at the organizational, account, and resource levels.

.Defense-in-Depth Security Architecture
[source,mermaid]
....
graph TD
    classDef preventative fill:#FFD0D0,stroke:#333,stroke-width:1px;
    classDef detective fill:#D0E8FF,stroke:#333,stroke-width:1px;
    classDef protective fill:#D0FFD0,stroke:#333,stroke-width:1px;
    classDef administrative fill:#FFFFD0,stroke:#333,stroke-width:1px;

    org["Organization Level"]
    acct["Account Level"]
    vpc["Network Level"]
    res["Resource Level"]
    data["Data Level"]

    org --> |SCPs| acct
    org --> |Organization Policies| acct
    acct --> |IAM| vpc
    acct --> |Config Rules| vpc
    acct --> |Security Services| vpc
    vpc --> |Security Groups| res
    vpc --> |NACLs| res
    vpc --> |Network Firewall| res
    res --> |Resource Policies| data
    res --> |Encryption| data

    class org preventative
    class acct detective
    class vpc protective
    class res administrative
    class data administrative
....

=== Why Security Architecture Matters in a Landing Zone

The security architecture in a landing zone establishes the foundation for your organization's cloud security posture. It determines:

* How security services are deployed and managed across accounts
* How preventative and detective controls are implemented
* How identity and access are governed
* How data is protected at rest and in transit
* How compliance requirements are addressed through automated mechanisms

A well-designed security architecture enables consistent security controls, provides defense in depth, and reduces the complexity of maintaining a strong security posture as your AWS footprint expands.

This document outlines the key security components of the LZA Universal Configuration, organized into these major areas:

* <<aws-control-tower-integration,AWS Control Tower Integration>>: How LZA extends Control Tower's security foundation
* <<delegated-security-administration,Delegated Security Administration>>: Centralized security management through the Audit account
* <<default-security-controls,Default Security Controls>>: Organization-wide preventative guardrails 
* <<identity-and-access-management,Identity and Access Management>>: Comprehensive authentication and authorization controls
* <<data-protection,Data Protection>>: Safeguarding data throughout its lifecycle
* <<security-information-and-event-management,Security Information and Event Management>>: Logging and monitoring framework
* <<integrated-security-operations,Integrated Security Operations>>: Detection and response capabilities

=== AWS Control Tower Integration

https://docs.aws.amazon.com/controltower/latest/userguide/what-is-control-tower.html[AWS Control Tower] provides a streamlined way to set up and govern a secure, multi-account AWS environment. The Landing Zone Accelerator (LZA) Universal Configuration is designed to complement and extend Control Tower's capabilities by adding customizable security configurations, infrastructure deployments, and governance controls.

The integration creates a symbiotic relationship where Control Tower provides link:https://docs.aws.amazon.com/controltower/latest/controlreference/mandatory-controls.html[standardized governance guardrails] and account provisioning, while the LZA Universal Configuration augments these capabilities with enhanced customization, security, and infrastructure automation. This architecture carefully respects Control Tower's boundaries - LZA's Service Control Policies (SCPs) are designed to complement Control Tower guardrails without causing conflicts, preserving the integrity of both systems.

When an organization uses Control Tower's Account Factory to provision new accounts, the LZA Universal Configuration automatically applies additional customizations to these accounts. This extends beyond Control Tower's baseline by link:https://docs.aws.amazon.com/controltower/latest/userguide/roles-how.html[deploying specialized IAM roles], comprehensive networking configurations, and enhanced security monitoring services. For instance, while Control Tower configures basic AWS Config rules, LZA Universal Configuration configures additional Control Tower controls while also provisioning it's own AWS Config rules. 

Organizations benefit tremendously from this integration through simplified operational management. Control Tower's dashboard continues to serve as the central governance interface, while LZA's automation handles complex customizations behind the scenes. This consolidation creates a single source of truth for account management while still providing the flexibility to adapt to specific organizational needs. The enhanced governance model combines Control Tower's mandatory guardrails with LZA's additional preventative and detective controls, creating comprehensive protection across the entire AWS organization.

The integration is particularly valuable for organizations with specific compliance requirements. Control Tower provides a strong baseline compliance foundation, while LZA offers comprehensive capabilities to implement additional controls for frameworks like NIST, CIS, or industry-specific regulations without disrupting Control Tower's established governance structure. The Universal Configuration enhances this by providing pre-configured, tested implementations of additional controls, enabling organizations to rapidly deploy compliance frameworks while maintaining operational efficiency and adapting to evolving regulatory requirements.

[IMPORTANT]
====
When integrating Control Tower with LZA, be mindful of Service Control Policy (SCP) limits. AWS Organizations has a quota of 5 SCPs attached to an account or OU. LZA reserves SCP quota for Control Tower's region deny controls by attaching some policies at the account level rather than the OU level.
====

== Base Security Configuration

The base security configuration establishes foundational security controls that apply across the entire AWS organization. These controls form the first layer of defense in the landing zone's security architecture, ensuring that all accounts maintain a baseline level of security.

Key security components used throughout the landing zone include:

* *Service Control Policies (SCPs)*: Preventative guardrails applied at the organization level
* *AWS Config Rules*: Detective controls to monitor resource compliance
* *IAM Policies and Roles*: Identity and access management controls
* *AWS Security Services*: Centrally managed security services with delegated administration

The LZA Universal Configuration implements these security components through a defense-in-depth approach, with multiple layers of controls working together to protect your environment.

[TIP]
====
See the <<Introduction to Landing Zone Security>> section for the Defense-in-Depth Security Architecture diagram that illustrates the layered security approach across organization, account, network, resource, and data levels.
====

=== Delegated Security Administration

The LZA Universal Configuration implements a centralized security management architecture that leverages AWS Organizations' delegated administrator capability. This modern approach to security governance shifts away from the traditional model of managing security from the Management account, creating a more secure and operationally efficient environment for security teams.

At the heart of this architecture is the designation of the Audit account as the centralized security administrator.

.Delegated Security Administration Architecture
[source,mermaid]
....
flowchart TD
    classDef management fill:#FFD0D0,stroke:#333,stroke-width:1px;
    classDef delegated fill:#D0FFD0,stroke:#333,stroke-width:1px;
    classDef member fill:#D0E8FF,stroke:#333,stroke-width:1px;
    classDef service fill:#FFFFD0,stroke:#333,stroke-width:1px;

    mgmt[Management Account]:::management
    audit[Audit Account]:::delegated
    members[Member Accounts]:::member
    
    gd[GuardDuty]:::service
    sh[Security Hub]:::service
    macie[Macie]:::service
    config[AWS Config]:::service
    
    mgmt -->|"Delegates administration"| audit
    audit -->|"Manages security"| members
    
    audit -->|"Administers"| gd
    audit -->|"Administers"| sh
    audit -->|"Administers"| macie
    audit -->|"Administers"| config
    
    gd -->|"Monitors"| members
    sh -->|"Evaluates"| members
    macie -->|"Scans"| members
    config -->|"Assesses"| members
....

When the LZA Universal Configuration deploys, it automatically configures delegated administration relationships for critical security services including GuardDuty, Security Hub, and Macie. This architecture creates a security governance model where findings, and alerts are centralized in the Audit account, while the actual security services operate across all accounts in the organization.

The implementation creates clear separation of duties between account management functions in the Management account and security operations in the Audit account. This segregation follows security best practices by limiting access to the privileged Management account while giving security teams the comprehensive access they need within the dedicated Audit account.

Security teams benefit tremendously from this centralized approach - they can monitor and respond to security events across the entire organization from a single account interface. This consolidation streamlines security operations by eliminating the need to switch between accounts when investigating potential security incidents. Additionally, access control is simplified as permissions for security management can be granted within a single account rather than distributed across the organization.

Perhaps most importantly, this architecture enhances security visibility by aggregating findings from all accounts into a central location. When GuardDuty detects suspicious activity in a workload account, or Macie identifies sensitive data in a development account, those findings are automatically routed to the Audit account where security analysts can view them alongside related findings, creating a comprehensive picture of the organization's security posture.

[IMPORTANT]
====
While the Audit account serves as the delegated administrator for security services, the Management account still maintains ultimate control over the organization. The delegated administrator model provides operational benefits while preserving the governance hierarchy required by AWS Organizations.
====

== Central AWS Security Services

The LZA Universal Configuration orchestrates a sophisticated security fabric across your entire AWS organization—moving beyond traditional siloed security approaches to create a unified defense ecosystem where specialized security services work in concert. This integrated approach transforms how organizations protect cloud environments, transitioning from fragmented security tools to a coordinated security operation center that spans all accounts and regions.

=== Intelligent Threat Detection with Amazon GuardDuty

At the core of the LZA Universal Configuration's security strategy lies Amazon GuardDuty—an advanced threat detection service that continuously analyzes billions of events across your AWS infrastructure using sophisticated machine learning, behavioral modeling, and threat intelligence.

Unlike traditional security tools that focus on narrow detection vectors, GuardDuty creates a comprehensive threat detection fabric that spans multiple layers of your cloud infrastructure—from network traffic to control plane operations to data access patterns:

.GuardDuty's Multi-Dimensional Threat Detection

[source,mermaid]
....
flowchart TD
    classDef sources fill:#D0E8FF,stroke:#333,stroke-width:1px;
    classDef processing fill:#D0FFD0,stroke:#333,stroke-width:1px;
    classDef intelligence fill:#FFD0D0,stroke:#333,stroke-width:1px;
    classDef output fill:#FFFFD0,stroke:#333,stroke-width:1px;

    vpc[VPC Flow Logs\nNetwork Traffic Patterns]:::sources
    trail[CloudTrail Events\nAPI Activity]:::sources
    dns[DNS Logs\nDomain Resolutions]:::sources
    s3[S3 Data Events\nObject Access]:::sources
    k8s[Kubernetes Audit Logs\nContainer Activity]:::sources
    rds[RDS Login Activity\nDatabase Access]:::sources
    
    gd[GuardDuty\nCorrelation Engine]:::processing
    ml[Machine Learning\nAnomaly Detection]:::processing
    
    aws[AWS Threat Intelligence\nKnown Threats]:::intelligence
    third[Third-Party Intelligence\nEmerging Threats]:::intelligence
    
    findings[Prioritized\nSecurity Findings]:::output
    hub[Security Hub\nIntegration]:::output
    events[EventBridge\nAutomation]:::output
    
    vpc --> gd
    trail --> gd
    dns --> gd
    s3 --> gd
    k8s --> gd
    rds --> gd
    
    aws --> gd
    third --> gd
    
    gd <--> ml
    
    gd --> findings
    findings --> hub
    findings --> events
....

The LZA Universal Configuration amplifies GuardDuty's protection beyond its basic implementation by activating specialized protection features for critical service domains:

* **S3 Data Protection**: Extends monitoring into your object storage layer, identifying suspicious access patterns that could indicate data exfiltration attempts, ransomware attacks, or credential misuse targeting your sensitive data stores. This capability is particularly valuable for organizations with large data lakes or significant amounts of unstructured data in S3.

* **EKS Cluster Protection**: Provides specialized monitoring for containerized workloads running on Amazon EKS, detecting Kubernetes-specific threats such as suspicious container activities, privilege escalation attempts, and potentially malicious lateral movement within cluster environments. This protection is crucial as organizations increasingly adopt container technologies that traditional security tools cannot effectively monitor.

Beyond threat detection, the configuration enhances the long-term investigative capabilities of your security operations by enabling automated findings export to S3. This continuous export creates a historical record of security findings that security teams can analyze using tools like link:https://docs.aws.amazon.com/athena/latest/ug/querying-guardduty.html[Amazon Athena] and QuickSight to identify long-term patterns, conduct forensic investigations, and develop proactive security improvements based on observed threat patterns.

=== Comprehensive Security Command Center with AWS Security Hub

While individual security services provide specialized protection capabilities, AWS Security Hub serves as the strategic command center for your organization's security operations. The LZA Universal Configuration transforms Security Hub from a simple dashboard into a sophisticated security intelligence platform that aggregates, normalizes, and correlates security findings while continuously benchmarking your environment against industry-standard security frameworks:

Security Hub's value extends far beyond simple dashboard views—it implements a sophisticated security intelligence engine that transforms raw security data into actionable insights through multi-stage processing:

.Security Hub's Intelligence Processing Pipeline
[source,mermaid]
....
flowchart TD
    classDef sources fill:#D0E8FF,stroke:#333,stroke-width:1px;
    classDef processing fill:#D0FFD0,stroke:#333,stroke-width:1px;
    classDef standards fill:#FFD0D0,stroke:#333,stroke-width:1px;
    classDef output fill:#FFFFD0,stroke:#333,stroke-width:1px;

    guard[GuardDuty\nThreat Intelligence]:::sources
    macie[Macie\nData Security]:::sources
    config[AWS Config\nCompliance]:::sources
    inspect[Inspector\nVulnerability Analysis]:::sources
    iam[IAM Access Analyzer\nExposure Analysis]:::sources
    third[Third-Party Security Tools\nExtended Intelligence]:::sources
    
    sh[Security Finding\nPipeline]:::processing
    norm[Format\nNormalization]:::processing
    corr[Cross-Service\nCorrelation]:::processing
    score[Security Score\nCalculation]:::processing
    
    fsbp[AWS Foundational\nSecurity Best Practices\n200+ Controls]:::standards
    nist[NIST 800-53\nRev 5\nFederal Standard]:::standards
    cis[CIS AWS\nBenchmark v3.0.0\nIndustry Standard]:::standards
    
    dash[Executive\nDashboards]:::output
    insights[Security\nInsights]:::output
    eb[EventBridge\nIntegration]:::output
    auto[Security\nWorkflows]:::output
    
    guard --> sh
    macie --> sh
    config --> sh
    inspect --> sh
    iam --> sh
    third --> sh
    
    sh --> norm
    norm --> corr
    corr --> score
    
    fsbp --> sh
    nist --> sh
    cis --> sh
    
    sh --> dash
    sh --> insights
    sh --> eb
    eb --> auto
....

The LZA Universal Configuration activates multiple complementary security standards that work together to create comprehensive security coverage across different compliance domains:

* **AWS Foundational Security Best Practices (FSBP)**: Implements over 200 automated security controls that reflect AWS's continuously updated security recommendations. Unlike static security standards, FSBP evolves with AWS's services to address emerging threats and new service capabilities, ensuring your security posture remains current even as cloud technologies advance.

* **NIST Special Publication 800-53 Revision 5**: Provides structured mapping between AWS security controls and this authoritative federal security standard, creating a compliance bridge that helps organizations demonstrate alignment with critical regulatory frameworks. This standard is particularly valuable for organizations subject to FedRAMP, FISMA, or other government regulations that reference NIST guidance.

* **CIS AWS Foundations Benchmark v3.0.0**: Implements the industry's most recognized cloud security standard developed by the Center for Internet Security. This framework represents consensus-based secure configuration guidelines that establish a verified security baseline that auditors and compliance assessors often look for when evaluating cloud environments.

By enabling all three standards simultaneously, the configuration creates overlapping security verification that addresses both technical and compliance requirements. This multi-standard approach ensures that security gaps missed by one framework will likely be caught by another, creating defense-in-depth at the compliance level.

The configuration further enhances Security Hub's capabilities by enabling cross-region aggregation—a sophisticated feature that creates a unified security view across all AWS regions. This implementation ensures that regional security findings don't remain isolated, eliminating potential blind spots while dramatically simplifying security operations. Security analysts can work from a single consolidated view rather than switching between regions, increasing efficiency and ensuring consistent security coverage regardless of where resources are deployed.

[IMPORTANT]
====
The Security Hub implementation includes automated integration with AWS EventBridge, enabling sophisticated security automation workflows. This capability transforms Security Hub from a passive monitoring tool into an active security enforcement mechanism that can trigger automated responses to security events—from simple notifications to complex remediation actions that can contain and resolve threats with minimal human intervention.
====

=== Sensitive Data Discovery and Protection with Amazon Macie

While GuardDuty focuses on detecting threats and Security Hub provides posture management, Amazon Macie addresses a specific and critical security challenge—discovering and protecting sensitive data stored in Amazon S3 buckets. The LZA Universal Configuration deploys Macie with careful attention to operational efficiency and meaningful alerts.

Macie employs sophisticated discovery mechanisms that combine bucket analysis, object evaluation, and content inspection to build a comprehensive map of sensitive data across your organization:

.Macie Sensitive Data Discovery Pipeline
[source,mermaid]
....
flowchart TD
    classDef discovery fill:#D0E8FF,stroke:#333,stroke-width:1px;
    classDef analysis fill:#D0FFD0,stroke:#333,stroke-width:1px;
    classDef results fill:#FFFFD0,stroke:#333,stroke-width:1px;
    classDef integration fill:#FFD0D0,stroke:#333,stroke-width:1px;

    s3[S3 Buckets]:::discovery
    bucketd[Bucket Discovery\nPermission Analysis]:::discovery
    objd[Object Discovery\nMetadata Analysis]:::discovery
    
    sampling[Intelligent Sampling\nRisk-Based Selection]:::analysis
    classify[Data Classification\nContent Evaluation]:::analysis
    patterns[Pattern Matching\nRegular Expressions]:::analysis
    ml[Machine Learning\nContextual Analysis]:::analysis
    
    policy[Policy Findings\nBucket Configuration]:::results
    sensitive[Sensitive Data Findings\nObject Content]:::results
    
    sh[Security Hub\nIntegration]:::integration
    s3notif[S3 Object Tags\nMetadata Enrichment]:::integration
    events[EventBridge Events\nAutomation Triggers]:::integration
    
    s3 --> bucketd
    bucketd --> objd
    objd --> sampling
    
    sampling --> classify
    classify --> patterns
    classify --> ml
    
    bucketd --> policy
    patterns --> sensitive
    ml --> sensitive
    
    policy --> sh
    sensitive --> s3notif
    sensitive --> events
    policy --> events
....

The configuration makes a deliberate choice to focus Security Hub integration on policy findings—such as unencrypted buckets or public access settings—while maintaining sensitive data findings within Macie's specialized console. This thoughtful separation helps prevent alert fatigue in Security Hub while still providing comprehensive data protection.

Macie's value extends beyond simple compliance checkboxes by providing actionable intelligence about your data landscape:

* **Data Risk Assessment**: Creates a comprehensive map of sensitive data across your S3 environment, allowing you to understand where your most valuable and regulated data resides
* **Discovery of Unknown Data**: Often identifies sensitive data in unexpected locations that might otherwise go unnoticed in large S3 deployments
* **Continuous Monitoring**: Provides ongoing visibility as new data is added to S3 buckets, ensuring that new sensitive data doesn't go unprotected
* **Precise Remediation**: Enables targeted encryption, access control, and data lifecycle policies based on actual sensitive data locations rather than blanket approaches

This targeted visibility into sensitive data helps organizations address specific regulatory requirements like GDPR, HIPAA, PCI DSS, and CCPA that mandate protection for particular data categories. By knowing exactly where regulated data resides, security teams can implement precise controls rather than overly restrictive policies that might impede legitimate business operations.

[IMPORTANT]
.Macie Alerting Configuration Required
====
The LZA Universal Configuration separates policy findings and sensitive data findings as a best practice, but *does not automatically configure Macie alerting mechanisms*. 

Without this explicit configuration, sensitive data findings will remain visible only within the Macie console, potentially delaying critical response actions. Organizations should implement these notification pathways as part of their LZA deployment to ensure complete coverage of both policy violations and sensitive data discoveries.
====

=== Resource Exposure Analysis with IAM Access Analyzer

Complementing the threat detection of GuardDuty, the compliance monitoring of Security Hub, and the data protection of Macie, the LZA Universal Configuration deploys IAM Access Analyzer to continuously monitor for unintended external access to your AWS resources.

Unlike traditional permission analysis tools that focus only on IAM policies, Access Analyzer employs sophisticated logical reasoning to evaluate the combined effect of resource policies across multiple AWS services:

.Access Analyzer Comprehensive Policy Evaluation
[source,mermaid]
....
flowchart TD
    classDef resources fill:#D0E8FF,stroke:#333,stroke-width:1px;
    classDef analyzer fill:#D0FFD0,stroke:#333,stroke-width:1px;
    classDef findings fill:#FFFFD0,stroke:#333,stroke-width:1px;
    classDef actions fill:#FFD0D0,stroke:#333,stroke-width:1px;

    s3p[S3 Bucket Policies]:::resources
    iamr[IAM Role Trust Policies]:::resources
    kms[KMS Key Policies]:::resources
    lambda[Lambda Resource Policies]:::resources
    sqs[SQS Queue Policies]:::resources
    sns[SNS Topic Policies]:::resources
    glacier[Glacier Vault Policies]:::resources
    secrets[Secrets Manager\nResource Policies]:::resources
    
    analyzer[Access Analyzer\nLogical Reasoning Engine]:::analyzer
    
    external[External Access Findings]:::findings
    unused[Unused Access Findings]:::findings
    
    remediate[Policy Remediation]:::actions
    archive[Finding Archival]:::actions
    
    s3p & iamr & kms & lambda & sqs & sns & glacier & secrets --> analyzer
    
    analyzer --> external
    analyzer --> unused
    
    external --> remediate
    external --> archive
    unused --> remediate
    unused --> archive
....

Access Analyzer serves as a continuous security guardian that identifies resources that might be accessible to external entities—whether intentionally or accidentally. This capability is particularly valuable for preventing data leakage through misconfigured resource policies, which traditional IAM analysis tools often miss since they focus primarily on identity permissions rather than resource accessibility.

The service provides two critical types of findings:

* **External Access Findings**: Identifies AWS resources that can be accessed by principals outside your organization boundary, helping prevent unintended data exposure to third parties or the general public

* **Unused Access Findings**: Helps implement least privilege by identifying permissions that are granted but never used, allowing you to refine access policies without disrupting operations

When integrated with the broader security framework, Access Analyzer adds a critical dimension of security analysis focused specifically on resource exposure. While other services monitor for active threats or policy compliance, Access Analyzer proactively identifies potential security gaps before they can be exploited—transforming security from reactive to preventative.

This suite of integrated security services—GuardDuty, Security Hub, Macie, and Access Analyzer—creates a comprehensive security framework that addresses different dimensions of cloud security. The centralized administration through the Audit account, combined with organization-wide deployment, ensures consistent protection across your entire AWS environment with minimal operational overhead.

Additionally, Security Hub's integration with AWS EventBridge enables sophisticated automation workflows based on security findings. This capability transforms Security Hub from a passive monitoring tool into an active security enforcement mechanism that can automatically respond to security events, from simple notifications to complex remediation actions.

== Organization and Account Security

The LZA Universal Configuration implements a sophisticated governance framework that creates a consistent security posture across your entire AWS organization. Unlike traditional approaches that rely on account-by-account security implementation, this centralized framework establishes organization-wide guardrails that create predictable, enforceable security boundaries while maintaining the flexibility needed for diverse workloads.

.Defense-in-Depth Organization Controls
[source,mermaid]
....
flowchart TD
    classDef preventative fill:#FFD0D0,stroke:#333,stroke-width:1px;
    classDef detective fill:#D0E8FF,stroke:#333,stroke-width:1px;
    classDef remediation fill:#D0FFD0,stroke:#333,stroke-width:1px;
    classDef management fill:#FFFFD0,stroke:#333,stroke-width:1px;

    scps[Service Control\nPolicies]:::preventative
    tag[Tagging\nPolicies]:::management
    backup[Backup\nPolicies]:::management
    
    config[AWS Config\nRules]:::detective
    findings[Security Hub\nFindings]:::detective
    
    auto[Automated\nRemediation]:::remediation
    
    root["Root OU"]
    infra["Infrastructure OU"]
    security["Security OU"]
    workloads["Workloads OU"]
    
    scp1["Core\nGuardrails"]:::preventative
    scp2["Infrastructure\nGuardrails"]:::preventative
    scp3["Workload\nGuardrails"]:::preventative
    quar["Quarantine\nPolicy"]:::preventative
    
    rule1["Identity &\nAccess Rules"]:::detective
    rule2["Network\nSecurity Rules"]:::detective
    rule3["Data Protection\nRules"]:::detective
    
    ssm["SSM\nAutomation"]:::remediation
    
    scps --> scp1 & scp2 & scp3 & quar
    config --> rule1 & rule2 & rule3
    
    scp1 & scp2 & scp3 --> |"Prevents\nViolations"| root
    rule1 & rule2 & rule3 --> |"Detects\nViolations"| root
    
    rule1 & rule2 & rule3 --> findings
    findings --> auto
    auto --> ssm
    
    tag --> root
    backup --> root
    
    root --> infra & security & workloads
....

This multi-layered approach combines both preventative and detective controls to create a robust security foundation. The preventative controls establish firm boundaries that cannot be bypassed, while detective controls continuously verify compliance and enable automated remediation when necessary. Together, these mechanisms ensure that security policies are not just documented guidelines but actively enforced safeguards.

=== Preventative Controls (SCPs)

The LZA Universal Configuration leverages Service Control Policies (SCPs)—a powerful AWS Organizations capability—to implement preventative security guardrails across your AWS environment. Unlike traditional IAM policies that grant permissions, SCPs establish hard boundaries that cannot be exceeded regardless of local account permissions.

The implementation creates a sophisticated hierarchy of SCPs that apply different security controls based on the specific needs and trust levels of various organizational units:

.Strategic SCP Deployment Architecture
[source,mermaid]
....
graph TD
    classDef core fill:#D0E8FF,stroke:#333,stroke-width:1px;
    classDef infrastructure fill:#D0FFD0,stroke:#333,stroke-width:1px;
    classDef workloads fill:#FFFFD0,stroke:#333,stroke-width:1px;
    classDef quarantine fill:#FFD0D0,stroke:#333,stroke-width:1px;
    classDef security fill:#F0D0FF,stroke:#333,stroke-width:1px;

    root["Root OU"]
    infra["Infrastructure OU"]
    security["Security OU"]
    workloads["Workloads OU"]
    suspended["Suspended OU"]
    sandbox["Sandbox OU"]
    dev["Dev OU"]
    test["Test OU"]
    prod["Prod OU"]
    
    core1["Core Guardrails-1\nProtects CloudTrail,\nConfig, Lambda, etc."]:::core
    core2["Core Guardrails-2\nProtects security services\n& prevents root usage"]:::core
    secg["Security Guardrails\nProtects network resources\n& enforces encryption"]:::security
    infrag["Infrastructure Guardrails\nProtects network resources\n& enforces encryption"]:::infrastructure
    workg["Workload Guardrails\nRestricts network modifications\n& enforces encryption"]:::workloads
    quar["Quarantine Policy\nIsolates new accounts\nuntil properly configured"]:::quarantine
    
    root --> infra
    root --> security
    root --> workloads
    root --> suspended
    workloads --> sandbox
    workloads --> dev
    workloads --> test
    workloads --> prod
    
    infra --> |"Attached"| core1
    infra --> |"Account-level"| core2
    infra --> |"Account-level"| infrag
    
    security --> |"Attached"| core1
    security --> |"Account-level"| core2
    security --> |"Account-level"| secg
    
    workloads --> |"Attached"| core1
    workloads --> |"Account-level"| core2
    
    sandbox --> |"Attached"| workg
    dev --> |"Attached"| workg
    test --> |"Attached"| workg
    prod --> |"Attached"| workg
    
    subgraph "New Account"
        new((New Account)) --> |"Temporary"| quar
    end
....

Each SCP type fulfills a specific security function within this comprehensive architecture:

==== Foundational Security with Core Guardrails

The LZA Universal Configuration establishes comprehensive preventative guardrails through Service Control Policies that create a robust security foundation across the AWS organization. These guardrails implement multiple layers of protection:

*Root Account Protection*::
Prevents the use of the root user account across the organization through a deny-all policy, enforcing the security best practice of root account disablement.

*Security Service Protection*::
Prevents unauthorized modification or disablement of critical security services including GuardDuty, Macie, Security Hub, IAM Access Analyzer, and account-level security settings like S3 public access blocks and EBS encryption defaults.

*LZA Infrastructure Protection*::
Shields the entire Landing Zone infrastructure from unauthorized changes through targeted SCPs that protect:

* CloudFormation stacks deployed by the accelerator
* Lambda functions that provide automation and security controls
* SNS topics used for notifications and alerts
* CloudWatch Logs containing security and operational data
* Systems Manager parameters storing configuration data
* S3 buckets containing deployment artifacts and configurations
* IAM roles that enable secure cross-account operations

*Configuration Management*::
Protects AWS Config rules and resources tagged by the accelerator, ensuring continuous compliance assessment remains tamper-resistant.

*Authorized Access*::
Implements conditions that permit changes only through authorized roles (including accelerator deployment roles and management access roles), while blocking all other attempts to modify the protected resources.

These guardrails are strategically deployed across Infrastructure, Security, and Workloads OUs, with specialized protections for Audit and Log Archive accounts, creating defense-in-depth that preserves the integrity of the entire security architecture.

==== Critical Network Protection with Security Guardrails

The LZA Universal Configuration implements specialized protective guardrails for security accounts through targeted Service Control Policies that restrict unauthorized network infrastructure changes. These guardrails establish critical protections for the Security OU and its member accounts.

*Network Infrastructure Protection*::
Prevents unauthorized creation of critical networking components by restricting actions on:

* VPC creation from unauthorized principals
* Internet gateway creation from unauthorized principals

These guardrails are strategically applied at the account level to Audit and LogArchive accounts rather than at the OU level. This targeted deployment preserves SCP quota for AWS Control Tower region deny controls while maintaining comprehensive protection for security resources.

The implementation includes exception conditions that allow authorized roles (accelerator deployment roles and management access roles) to make legitimate changes while blocking all unauthorized modification attempts.

==== Critical Network Protection with Infrastructure Guardrails

The LZA Universal Configuration implements specialized protective guardrails for infrastructure accounts through targeted Service Control Policies that secure both networking resources and enforce encryption standards. These guardrails create a comprehensive security framework specifically for accounts managing foundational infrastructure components.

*Network Infrastructure Protection*::
Prevents unauthorized modifications to critical networking components by restricting actions on:

* VPC resources including creation, deletion, and configuration changes
* Transit Gateway configurations and associations
* Route tables and subnet configurations
* Internet gateways, NAT gateways, and VPC endpoints
* IP address management (IPAM) operations

*Network Security Protection*::
Secures network security configurations by preventing unauthorized changes to:

* Network Firewall resources deployed by the accelerator
* Firewall policies that define security rules
* Stateful and stateless rule groups that implement security controls

*Encryption Requirements*::
Enforces storage encryption across services by denying:

* Creation of unencrypted EFS file systems
* Deployment of unencrypted RDS database instances
* Creation of unencrypted Aurora database clusters

*Resource Tag Protection*::
Prevents deletion of tags on resources managed by the accelerator, ensuring consistent identification and management of LZA-deployed resources.

These guardrails are strategically applied at the account level to Network, Perimeter, and SharedServices accounts rather than at the OU level. This targeted deployment preserves SCP quota for AWS Control Tower region deny controls while maintaining comprehensive protection for infrastructure resources.

The implementation includes exception conditions that allow authorized roles (accelerator deployment roles and management access roles) to make legitimate changes while blocking all unauthorized modification attempts.

==== Specialized Workload Protection with Workload Guardrails

The LZA Universal Configuration applies tailored guardrails across development, testing, and production workload environments through Service Control Policies that establish consistent security controls while allowing application deployment flexibility. These guardrails create an effective balance between security enforcement and operational agility.

*Network Architecture Protection*::
Prevents unauthorized modifications to the foundational network architecture by restricting operations on:

* VPC resources including creation, modification, and deletion
* Transit Gateway configurations and associations
* Subnet and route table manipulations
* Internet gateways, NAT gateways, and VPC endpoints
* IP address management and VPC peering connections

*Accelerator Resource Protection*::
Prevents deletion of resource tags created by the accelerator, ensuring LZA-deployed resources maintain their identification and can be properly managed through automation.

*Data Protection Requirements*::
Enforces encryption for data storage services across all workload environments:

* Requires encryption for all EFS file systems
* Mandates storage encryption for RDS database instances
* Enforces encryption for Aurora database clusters

These guardrails are consistently applied across the entire workload hierarchy—covering Development, Test, and Production organizational units—creating standardized security boundaries regardless of environment maturity. The controls focus specifically on protecting network architecture and enforcing data encryption while allowing teams sufficient flexibility to deploy and manage application resources within these secure boundaries.

The implementation includes exception conditions for authorized roles (accelerator deployment roles and management access roles) that can make legitimate infrastructure changes when necessary, while preventing all other identities from modifying the secure foundation.

==== Safety Net for New Accounts with Quarantine Policy

The LZA Universal Configuration implements a comprehensive security control that places newly created accounts into a strictly controlled quarantine state. This mechanism provides complete protection during the critical initial deployment phase.

*Complete Account Lockdown*::
The quarantine SCP implements the most restrictive possible control by denying *all* AWS actions across *all* resources. This complete lockdown ensures that no resources can be created, modified, or accessed until proper security controls are established.

*Automated Provisioning Exception*::
The only exceptions to the quarantine are specifically authorized LZA deployment roles:

* The management account access role for cross-account operations
* LZA accelerator roles that implement the secure baseline
* CDK accelerator roles that deploy infrastructure as code

*Temporary Protection Mechanism*::
The quarantine control is applied automatically upon account creation and remains in place only until the LZA deployment pipeline successfully establishes all baseline security controls, networking configurations, and compliance mechanisms. Once these foundations are in place, the quarantine is automatically removed.

*Zero Trust Approach*::
This implementation represents a zero-trust security model for account provisioning—creating a secure-by-default posture that eliminates the common security gap between account creation and security control implementation.

This proactive security control ensures that no account can be utilized until it meets the organization's complete security baseline, effectively preventing any potential for misconfigurations, security drift, or unauthorized resource deployment during the vulnerable initial account setup phase.

[IMPORTANT]
====
Service Control Policies represent the strongest form of access control in AWS Organizations, as they cannot be overridden by local permissions. However, they have important limitations to consider when designing your governance framework:

* AWS Organizations has a quota of 5 SCPs that can be attached to any account or OU
* SCPs don't affect service-linked roles or the root user in the management account
* Some services and actions have specific SCP limitations

For a complete list of limitations, refer to the https://docs.aws.amazon.com/organizations/latest/userguide/orgs_manage_policies_scps.html#scp-effects-on-permissions[AWS Organizations documentation].
====

=== Detective Controls (Config Rules)

While SCPs provide preventative guardrails that cannot be bypassed, the LZA Universal Configuration also implements comprehensive detective controls through AWS Config rules. These rules continuously evaluate the configuration of resources across your AWS environment, detecting any deviations from security best practices or organizational requirements.

The LZA Universal Configuration deploys 30 AWS Config rules with an optional 5 across multiple security domains, creating a comprehensive compliance monitoring system that continuously evaluates your AWS environment against best practices and organizational requirements.

.AWS Config Evaluation Process with Security Hub Integration
[source,mermaid]
....
flowchart LR
    classDef resources fill:#D0E8FF,stroke:#333,stroke-width:1px;
    classDef evaluation fill:#D0FFD0,stroke:#333,stroke-width:1px;
    classDef findings fill:#FFFFD0,stroke:#333,stroke-width:1px;
    classDef remediation fill:#FFD0D0,stroke:#333,stroke-width:1px;
    classDef securityhub fill:#F0D0FF,stroke:#333,stroke-width:1px;

    change[Resource\nConfiguration\nChange]:::resources
    periodic[Periodic\nEvaluation]:::resources
    
    config[AWS Config\nEvaluation\nEngine]:::evaluation
    rules[AWS Config\nRules]:::evaluation
    
    compliant[Compliant\nResources]:::findings
    noncompliant[Non-Compliant\nResources]:::findings
    
    auto[Automated\nRemediation]:::remediation
    securityhub[AWS Security Hub\nFindings Dashboard]:::securityhub
    
    change --> config
    periodic --> config
    
    config <--> rules
    
    config --> compliant
    config --> noncompliant
    
    noncompliant --> auto
    noncompliant -->|Compliance findings\nforwarded to Security Hub| securityhub
    auto --> change
....

==== Management Account Security Monitoring

The LZA Universal Configuration pays special attention to the Management account, implementing additional Config rules that Control Tower cannot deploy in this privileged account.

This implementation recognizes that the Management account requires special protection due to its privileged position in the AWS Organizations hierarchy. By deploying these additional Config rules, LZA ensures that even the most privileged account in your organization is subject to continuous security monitoring and compliance verification.

==== Cross-Reference to Security Standards

The Config rules in the LZA Universal Configuration align with industry security standards and best practices. For more information on how these rules map to specific compliance frameworks, see:

* <<security-information-and-event-management,Security Information and Event Management>>: Details how these findings integrate with Security Hub standards
* <<central-aws-security-services,Central AWS Security Services>>: Explains how findings are consolidated and analyzed

==== Automated Remediation

Beyond simply detecting non-compliant resources, the LZA Universal Configuration implements automated remediation capabilities that can automatically correct security issues without human intervention.

This advanced capability transforms AWS Config from a passive monitoring tool into an active enforcement mechanism that can maintain your security posture even as your environment changes. When a non-compliant resource is detected, the automated remediation process is run.

== Identity and Access Management

The LZA Universal Configuration implements a sophisticated identity and access management framework that addresses the fundamental security challenge of modern cloud environments—creating robust protection while enabling operational agility. Unlike traditional approaches that create an adversarial relationship between security and operations, this framework establishes a governance model where strong security controls actually enhance operational capabilities rather than hindering them.

=== Enterprise Authentication through IAM Identity Center

The LZA Universal Configuration establishes AWS IAM Identity Center as the cornerstone of human access management, creating a unified authentication framework that integrates with your existing enterprise identity provider.

By designating the SharedServices account as the delegated administrator for Identity Center, the configuration creates an intentional separation between organizational management and identity administration—a crucial security principle that prevents concentrated privilege in the Management account.

.Identity Center Authentication Flow
[source,mermaid]
....
flowchart LR
    classDef corporate fill:#D0E8FF,stroke:#333,stroke-width:1px;
    classDef aws fill:#D0FFD0,stroke:#333,stroke-width:1px;
    classDef accounts fill:#FFD0D0,stroke:#333,stroke-width:1px;

    idp["Corporate Identity Provider\n(Active Directory, Okta, etc.)"]:::corporate
    idc["IAM Identity Center\n(SharedServices Account)"]:::aws
    portal["AWS Access Portal\nUnified Entry Point"]:::aws
    
    dev["Development Account\nPermission Set: Developer"]:::accounts
    prod["Production Account\nPermission Set: ReadOnly"]:::accounts
    
    idp -->|"Federation\nSAML 2.0/SCIM"| idc
    idc -->|"User Attributes\nGroup Membership"| portal
    portal -->|"Temporary Credentials\nSession-based Access"| dev
    portal -->|"Temporary Credentials\nSession-based Access"| prod
....

This implementation creates significant operational and security advantages:

* **Single Authentication Point**: Users authenticate once to access multiple accounts and applications
* **Attribute-Based Access Control**: Permissions dynamically adapt to user attributes from the corporate directory
* **Temporary Credential Model**: All access is provided through short-lived session tokens
* **Permission Sets**: Standardized permission collections ensure consistent access levels across accounts
* **Fine-Grained Authorization**: Access can be precisely tailored to specific job requirements

=== Standardized IAM Roles

The LZA Universal Configuration implements organization-wide IAM standardization by automatically deploying critical service roles to all accounts. This approach ensures consistent access patterns and security boundaries for infrastructure operations across the entire AWS organization.

For data protection operations, LZA provisions a dedicated `Backup-Role` with precisely scoped permissions through AWS managed policies. This role establishes the necessary trust relationship with the AWS Backup service, enabling centrally defined backup plans to function consistently across all accounts while maintaining the principle of least privilege.

To support operational management of compute resources, LZA deploys an `EC2-Default-SSM-Role` with an associated instance profile that enables secure, agent-based management through AWS Systems Manager. This standardized role combines permissions for systems management, monitoring, and patching while implementing a permission boundary that restricts the maximum allowed access—creating defense in depth that protects against privilege escalation.

This automated role deployment strategy eliminates account-by-account IAM configuration drift by ensuring that essential service roles are consistently provisioned with standardized permissions, trust relationships, and boundaries. The configuration specifically excludes the Management account from this standardization to maintain appropriate separation of duties in the organizational hierarchy.

==== Credential Protection with Enhanced Password Policies

While federation through Identity Center represents the primary authentication method for human access, the LZA Universal Configuration also implements robust security controls for IAM users through an enhanced password policy that exceeds industry standards.

This configuration implements a defense-in-depth approach to password security aligned with multiple regulatory frameworks and security standards:

* **CIS AWS Foundations Benchmark**: Meets or exceeds all password complexity requirements from the Center for Internet Security's recognized standard
* **NIST Special Publication 800-53**: Aligns with federal security controls for access management and credential protection
* **AWS Security Best Practices**: Follows AWS recommendations for secure credential management

The 14-character minimum with multi-factor complexity requirements creates passwords highly resistant to brute force attacks, while the 90-day rotation period and 24-password history prevent password reuse patterns that could compromise accounts over time. These controls ensure that any IAM users in your environment maintain a strong security posture aligned with organizational policies.

The configuration carefully balances security with usability through thoughtful settings:

* **Self-Service Capability**: Users can change their own passwords, reducing administrative overhead while maintaining security
* **Soft Expiry**: A grace period at password expiration prevents immediate lockout while still enforcing regular rotation
* **Comprehensive Requirements**: Multiple character type requirements prevent dictionary-based attacks

[IMPORTANT]
====
While the LZA Universal Configuration provides robust password controls, AWS best practice is to minimize the use of IAM users in favor of federated access through Identity Center. Password policies provide a security baseline for any IAM users that may be required for operational purposes, but federation should be the primary authentication method for human users.
====

=== IAM Policies

The LZA Universal Configuration establishes organization-wide governance through centrally managed IAM permission boundaries that enforce consistent security guardrails across all accounts. These policies create standardized protective boundaries that limit the maximum permissions any role can obtain, regardless of the policies attached to it.

==== Permission Boundaries and IAM Governance

The LZA Universal Configuration implements a sophisticated approach to privilege management through IAM permission boundaries—one of AWS's most powerful yet underutilized security controls. This mechanism creates a security perimeter that limits the maximum permissions any IAM entity can possess, preventing privilege escalation while enabling operational delegation.

===== Understanding Permission Boundaries

Permission boundaries are an AWS IAM feature that sets the maximum permissions that an identity-based policy can grant to an IAM entity (user or role). A permission boundary limits the entity's permissions but does not provide permissions on its own.

When using permission boundaries, the effective permissions for an IAM entity are determined by the intersection of:

1. *Permission boundary*: Sets the maximum allowed permissions
2. *Identity-based policies*: Policies attached directly to the user or role
3. *Resource-based policies*: Policies attached to resources being accessed
4. *Service Control Policies*: Organization-level permission guardrails

Effective permissions = (Identity policies ∩ Permission boundary ∩ Service Control Policies) ∪ Resource-based policies

===== Enforcement and Delegation

The End-User-Policy serves as a dual-purpose control that can function as both an identity-based policy that grants permissions and as a permission boundary that establishes maximum allowable permissions. This flexibility allows organizations to implement least privilege at scale while maintaining operational efficiency.

The boundary includes a critical enforcement mechanism that requires users to attach the same boundary when creating new roles, preventing privilege escalation:

[source,json]
----
{
  "Sid": "EnforceBoundary",
  "Effect": "Allow",
  "Action": ["iam:CreateRole", "iam:PutRolePermissionsBoundary"],
  "NotResource": [
    "arn:${PARTITION}:iam::*:role/aws-controltower-*",
    "arn:${PARTITION}:iam::*:role/${ACCELERATOR_PREFIX}-*",
    "arn:${PARTITION}:iam::*:role/AWSControlTowerExecution",
    "arn:${PARTITION}:iam::*:role/AWSCloudFormationStackSetExecutionRole",
    "arn:${PARTITION}:iam::*:role/cdk-accel-*"
  ],
  "Condition": {
    "ArnLike": {
      "iam:PermissionsBoundary": "arn:${PARTITION}:iam::*:policy/${ACCELERATOR_PREFIX}-End-User-Policy"
    }
  }
}
----

.Permission Boundary Enforcement Model
[source,mermaid]
....
flowchart TD
    classDef user fill:#D0E8FF,stroke:#333,stroke-width:1px;
    classDef boundary fill:#FFD0D0,stroke:#333,stroke-width:1px;
    classDef resource fill:#D0FFD0,stroke:#333,stroke-width:1px;
    classDef effective fill:#FFFFD0,stroke:#333,stroke-width:1px;
    
    dev["Developer\nIAM User/Role"]:::user
    pb["Permission Boundary\nMaximum Allowed Permissions"]:::boundary
    ip["Identity Policy\nGranted Permissions"]:::boundary
    
    newrole["New Role\nCreated by Developer"]:::resource
    newpb["Permission Boundary\nMust Be Attached"]:::boundary
    
    effective["Effective Permissions\nIdentity Policy ∩ Permission Boundary"]:::effective
    
    dev -->|"Limited by"| pb
    dev -->|"Granted by"| ip
    dev -->|"Creates"| newrole
    newrole -->|"Limited by"| newpb
    
    pb -->|"Intersection"| effective
    ip -->|"Intersection"| effective
....

This elegant security architecture enables a sophisticated delegation model where trusted teams can manage their own IAM resources without compromising organizational security. Rather than requiring central security teams to manage all IAM changes—creating operational bottlenecks—the permission boundary allows controlled delegation with automatic guardrails that prevent security risks. Development teams can create the roles they need for their operations, but those roles cannot exceed the permissions defined in the boundary, ensuring consistent security across the organization.

[NOTE]
====
Permission boundaries represent one of AWS's most sophisticated security controls for IAM governance. Unlike Service Control Policies that operate at the organization level, permission boundaries work at the identity level, creating a complementary layer of defense that enables secure delegation of IAM management while maintaining organizational security control.
====

*SSM Management Integration*::
The configuration also deploys a specialized policy that enables secure Systems Manager operations by providing precisely scoped access to essential S3 resources needed for patching, inventory, and configuration management.


== Data Protection

The LZA Universal Configuration implements a comprehensive data protection strategy that safeguards information throughout its entire lifecycle. This strategy combines powerful preventative controls with continuous monitoring to protect data across multiple dimensions—geographical location, encryption at rest, access control, transmission security, and data resilience.

The LZA Universal Configuration implements a comprehensive data protection framework that addresses five critical dimensions, creating layers of defense that work together to safeguard data throughout its lifecycle.

* *Data Perimeter Controls* establish geographical boundaries through Regional Deny mechanisms that enforce data sovereignty requirements and Transit Encryption that implements robust TLS protection for data in motion across networks.

* *Encryption Controls* provide essential protection for data at rest through multiple complementary services—AWS KMS handles centralized key management, while EBS Encryption secures volume data, S3 Encryption protects object storage, and Secrets Encryption safeguards sensitive credentials.

* *Access Controls* prevent unauthorized exposure by implementing S3 Public Access Block to eliminate accidental public sharing, IAM Policies that enforce principle of least privilege, and VPC Endpoints that enable private connectivity to AWS services without traversing the public internet. 
** <<S3 Public Access Block>>
** <<IAM Policies>>

* *Backup & Recovery* ensures data resilience through structured Backup Plans with scheduled protection, Retention Policies that manage the data lifecycle, and secure Backup Vaults that provide protected storage for recovery assets.

This multi-dimensional approach combines preventative guardrails with detective mechanisms to create a defense-in-depth strategy that protects information across its entire lifecycle—from creation and storage through transmission, access, and recovery.


=== Data Perimeter Controls

Complementing the encryption controls, the LZA Universal Configuration implements powerful exposure prevention mechanisms that ensure data remains accessible only to authorized users and services—even if other controls fail or are misconfigured.

==== S3 Public Access Block

The LZA Universal Configuration enforces comprehensive S3 data protection by implementing account-level Public Access Block settings across the entire AWS organization. Following security best practices, LZA deploys these controls through AWS Organizations service control policies (SCPs) and preventative guardrails that ensure consistent protection.

LZA Universal Configuration automatically provisions and enforces account-level S3 Block Public Access settings during account creation and enrollment, rather than relying on resource-level configurations. This approach aligns with AWS Well-Architected best practices by establishing security controls at the highest possible level in the organization hierarchy.

The configuration uses Infrastructure as Code templates to consistently deploy these settings, making them immutable through preventative guardrails that prohibit modifications to these critical security controls. LZA Universal Configuration implementation creates automated compliance reporting through AWS Config rules that continuously verify the public access block settings remain enforced across all accounts.

This systematic approach provides defense-in-depth protection against both deliberate and accidental exposure of sensitive data, while simultaneously simplifying compliance reporting and security assurance across large-scale multi-account environments.

==== Config Rules for Exposure Prevention

The LZA Universal Configuration extends exposure prevention beyond S3 through AWS Config rules that monitor for other potential data exposure vectors:

* **S3 Bucket Public Write Prohibition**: Ensures buckets don't allow public write access, preventing potential abuse
* **S3 Bucket Policy Grantee Check**: Verifies that bucket policies don't grant access to unintended principals
* **Unrestricted Route to IGW Check**: Confirms that route tables don't contain unrestricted routes to Internet Gateways
* **Internet Gateway VPC Authorization**: Ensures that Internet Gateways are attached only to authorized VPCs

Combined with the S3 Public Access Block controls, these Config rules create a comprehensive exposure prevention framework that addresses multiple potential data leakage vectors across your AWS environment.

==== Regional Deny as a Data Sovereignty Mechanism

AWS Control Tower's Regional Deny capability provides a powerful data perimeter control mechanism that enforces geographical boundaries for resource creation and data processing. This feature uses Service Control Policies (SCPs) to prevent AWS service actions in unauthorized regions, ensuring compliance with data sovereignty requirements while reducing attack surface. To implement Regional Deny, navigate to the https://console.aws.amazon.com/controltower/[AWS Control Tower console^], select "Controls" from the left navigation, then enable the "Disallow management of resources in specified regions" preventive control on your desired Organizational Units. For detailed configuration steps, refer to the https://docs.aws.amazon.com/controltower/latest/userguide/region-deny.html[AWS Control Tower Regional Deny documentation^] and the https://aws.amazon.com/blogs/mt/aws-control-tower-supports-data-residency-using-region-deny-and-guardrails/[implementation guide^] for best practices on data residency enforcement.

This sophisticated implementation of Regional Deny provides multiple strategic benefits:

* **Data Sovereignty Compliance**: Enforces geographical boundaries for data storage and processing, addressing regulatory requirements like GDPR, HIPAA, or country-specific data residency laws
* **Attack Surface Reduction**: Limits potential entry points for attackers by preventing resource creation in unauthorized regions, concentrating security controls on a manageable scope
* **Security Monitoring Optimization**: Focuses security tooling and personnel on a defined set of regions, enhancing detection capabilities through concentrated visibility
* **Operational Cost Efficiency**: Reduces the overhead of managing security controls across unused regions, allowing more effective resource allocation

[WARNING]
====
The LZA Universal Configuration does not automatically configure AWS Control Tower Regional Deny controls. This critical data perimeter control must be implemented manually through the AWS Control Tower console to ensure proper data sovereignty and compliance requirements are met.
====

=== Encryption Controls

The LZA Universal Configuration implements a sophisticated encryption framework built around AWS Key Management Service (KMS). This approach ensures consistent, strong encryption across all data storage services while maintaining strict control over the encryption keys themselves.

==== KMS Key Protection Controls

The LZA Universal Configuration safeguards encryption infrastructure by deploying organization-wide Service Control Policies (SCPs) that establish strict governance over KMS key operations. These preventative guardrails create fine-grained restrictions that limit key management actions exclusively to authorized identity roles.

LZA implements these controls by deploying strategically designed SCPs that explicitly deny critical KMS operations—including key deletion, policy modification, and rotation setting changes—unless performed by designated security roles. The configuration establishes these protected key patterns through CloudFormation templates that standardize key creation with appropriate permissions boundaries.

Following AWS key management best practices, LZA's approach separates encryption administration duties from application usage permissions, creating segregation of duties that aligns with compliance frameworks like PCI-DSS and NIST 800-53. The implementation includes automated monitoring through AWS Config rules that track any attempted violations of these key management policies.

By enforcing these protective boundaries at the organization level, LZA ensures the ongoing integrity of the encryption foundation that protects data across multiple accounts and environments, preventing security degradation through either inadvertent changes or malicious attempts to compromise key material.

==== Service-Specific Encryption Controls

The LZA Universal Configuration extends encryption protection across your AWS environment through service-specific controls enforced by AWS Config rules.

* **CloudWatch Logs**: Ensures that all log groups are encrypted to protect sensitive information in log data
* **DynamoDB Tables**: Verifies that tables are encrypted using customer-managed KMS keys rather than default encryption
* **Secrets Manager**: Confirms that secrets are protected with customer-managed KMS keys for enhanced control
* **API Gateway**: Checks that API cache is encrypted to protect potentially sensitive data cached during API operations
* **SageMaker**: Ensures that both notebook instances and endpoint configurations use KMS encryption

The combination of preventative controls through SCPs and detective controls through Config rules creates a robust encryption governance framework that protects data across your organization while enabling continuous verification of encryption compliance.

=== Backup and Recovery

Data protection is a critical aspect of any cloud environment, but implementing consistent backup strategies across multiple accounts and regions is a complex challenge. Organizations typically struggle with inconsistent backup policies, gaps in protection, manual backup management, and inadequate encryption controls. The LZA Universal Config addresses these challenges by implementing an enterprise-grade backup strategy that seamlessly integrates with the organizational structure while providing the flexibility to meet varying recovery requirements.

The LZA Universal Config delivers a complete AWS Backup implementation that automates backup processes across your entire organization. This approach ensures comprehensive data protection through standardized backup frequencies, retention periods, and security controls—all while enabling resource-specific customization through a simple tagging strategy.

==== Backup Policies

Organizations without standardized backup policies often face inconsistent data protection, complex recovery procedures, and potential compliance violations. The LZA Universal Config solves this through https://docs.aws.amazon.com/organizations/latest/userguide/orgs_manage_policies_backup.html[AWS Organizations Backup Policies] that enforce consistent backup strategies across your entire AWS footprint.

The LZA Universal Config defines backup policies as JSON files following the link:https://docs.aws.amazon.com/organizations/latest/userguide/orgs_manage_policies_backup_syntax.html[AWS Organizations Backup Policy Syntax] and attaches them to the Infrastructure and Workloads OUs. This approach ensures that all accounts within these OUs automatically inherit the appropriate backup configurations without manual intervention, eliminating protection gaps that commonly occur with account-by-account configuration.

==== Backup Schedules and Retention

The backup strategy implements a tiered approach to data protection with multiple recovery options:

[cols="1,2,2,2,2", options="header"]
|===
|Backup Type |Schedule |Retention Period |Cold Storage Transition |Purpose
|Continuous |Every hour (`cron(0 5/1 ? * * *)`) |35 days |N/A |Point-in-time recovery of critical systems
|Hourly |Every hour (`cron(0 5/1 ? * * *)`) |365 days |After 30 days |Rapid recovery with minimal data loss
|Daily |5:00 AM daily (`cron(0 5 ? * * *)`) |365 days |After 30 days |Standard operational recovery
|Weekly |5:00 AM Sunday (`cron(0 5 ? * 1 *)`) |365 days |After 30 days |Longer-term recovery points
|Monthly |5:00 AM on the 1st (`cron(0 5 1 * ? *)`) |730 days |After 60 days |Compliance and long-term retention
|===

For supported resource types, all backup strategies (except continuous backups) use a tiered storage approach where backups are stored in standard storage for the initial period before moving to cold storage for cost optimization. Cold storage transitions are supported only for Amazon EFS file systems in AWS Backup. Other resource types including EC2 instances (AMIs), EBS volumes, RDS databases (including Aurora), DynamoDB tables, S3 objects, Storage Gateway volumes, and FSx file systems remain in standard storage for their entire retention period.

==== Backup Resource Selection via Tagging

Resource selection for backup uses a tag-based approach that integrates with the tag policies described in the Tagging section. To include a supported resource in a backup plan, simply tag it with the `BackupPlan` tag and one of the valid values (`Continuous`, `Hourly`, `Daily`, `Weekly`, or `Monthly`). This tag-driven approach puts backup control in the hands of resource owners while maintaining centralized governance through tag policies that enforce valid values.

LZA Universal Config enforces this tagging strategy through AWS Organizations tagging policies, ensuring consistent backup tagging across your entire organization without manual configuration.

[IMPORTANT]
====
The effectiveness of the backup strategy depends on proper resource tagging. Resources without the `BackupPlan` tag will not be backed up. The LZA Universal Config implements tag policies (described in the Tagging section) that enforce valid values for the `BackupPlan` tag, ensuring that when resources are tagged for backup, they use consistent, predefined backup frequencies.
====

==== Windows VSS Support

For EC2 instances running Microsoft Windows, the backup policy enables Windows Volume Shadow Copy Service (VSS) to create application-consistent backups. This ensures that applications like SQL Server and Exchange have consistent backups without requiring custom scripts or application shutdowns while having no effect for other operating systems.

==== Backup Vaults

Secure storage of backup data requires proper encryption, access controls, and regional availability. The LZA Universal Config creates a comprehensive backup infrastructure through automated vault deployment across your organization.

For each account in the Infrastructure and Workloads OUs, the LZA Universal Config automatically provisions:

* An AWS Backup vault in each enabled region
* A dedicated AWS KMS Customer Managed Key (CMK) in each region for encryption
* Proper IAM permissions for backup operations
* Integration with the backup policies defined at the OU level

This approach ensures that backup data is:

1. *Always Encrypted* - All backups are automatically encrypted with account and region-specific KMS keys
2. *Regionally Available* - Backups are stored in the same region as source resources for fast recovery
3. *Properly Isolated* - Each account maintains its own backup data, supporting security boundaries
4. *Consistently Protected* - All vaults follow the same security and retention standards

[TIP]
====
When determining appropriate backup frequencies for your resources, consider:

* Recovery Point Objective (RPO) - How much data loss is acceptable?
* Recovery Time Objective (RTO) - How quickly must recovery be completed?
* Compliance Requirements - What retention periods are mandated?
* Cost Considerations - Higher backup frequencies and longer retention increase costs

The LZA Universal Config provides multiple backup options to balance these factors for different resource types.
====

== Security Best Practices and Considerations

When implementing your landing zone security architecture, consider these key security principles:

=== Defense in Depth

* Implement multiple layers of security controls at different levels
* Use both preventative controls (SCPs) and detective controls (Config rules)
* Apply security controls at the organization, account, VPC, and resource levels

=== Least Privilege

* Grant only the permissions needed to perform required tasks
* Use permission boundaries to limit maximum permissions
* Regularly review and update IAM policies to remove unnecessary permissions

=== Security Monitoring and Visibility

* Implement centralized logging for all security-relevant events
* Enable GuardDuty, Security Hub, and Macie for comprehensive threat detection
* Regularly review security findings and address identified issues

=== Automation and Standardization

* Use automated remediation for common security issues
* Implement standardized security controls across all accounts
* Use infrastructure as code for consistent security configurations

=== Regular Security Assessment

* Regularly assess your security posture against best practices
* Use Security Hub benchmarks to identify areas for improvement
* Conduct regular security reviews and penetration testing

== Additional Resources

For more information about AWS security services and best practices, refer to:

* link:https://docs.aws.amazon.com/organizations/latest/userguide/orgs_manage_policies_scps.html[Service Control Policies Documentation]
* link:https://docs.aws.amazon.com/config/latest/developerguide/WhatIsConfig.html[AWS Config Documentation]
* link:https://docs.aws.amazon.com/guardduty/latest/ug/what-is-guardduty.html[Amazon GuardDuty Documentation]
* link:https://docs.aws.amazon.com/securityhub/latest/userguide/what-is-securityhub.html[AWS Security Hub Documentation]
* link:https://docs.aws.amazon.com/macie/latest/user/what-is-macie.html[Amazon Macie Documentation]
* link:https://docs.aws.amazon.com/IAM/latest/UserGuide/what-is-access-analyzer.html[IAM Access Analyzer Documentation]
* link:https://docs.aws.amazon.com/IAM/latest/UserGuide/access_policies_boundaries.html[Permission Boundaries Documentation]
* link:https://docs.aws.amazon.com/aws-backup/latest/devguide/whatisbackup.html[AWS Backup Documentation]
* link:https://aws.amazon.com/blogs/security/establishing-a-data-perimeter-on-aws[Establishing a Data Perimeter on AWS]
* link:https://aws.amazon.com/architecture/security-identity-compliance[AWS Security Architecture]
* link:https://docs.aws.amazon.com/prescriptive-guidance/latest/aws-security-reference-architecture/welcome.html[AWS Security Reference Architecture]
